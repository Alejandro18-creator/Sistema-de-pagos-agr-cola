
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sistema AgrÃ­cola</title>

    <!-- RESPONSIVE -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ESTILOS -->
    <link rel="stylesheet" href="styles.css">

    <!-- FAVICON (opcional si existe archivo) -->
    <link rel="icon" href="favicon.ico">
</head>

<body>

<!-- LOGIN -->
<div id="login" class="card">
    <h2>Ingreso Contratista</h2>

    <input type="password"
           id="password"
           placeholder="ContraseÃ±a"
           autocomplete="off">

    <button type="button" onclick="loginUser()">
        Ingresar
    </button>
</div>

<!-- APP -->
<div id="app" class="hidden layout">

    <!-- MENÃš LATERAL -->
    <aside class="sidebar">
        <h2>ğŸŒ± Sistema</h2>

        <button type="button" onclick="showView('viewHome')">ğŸ  Inicio</button>
        <button type="button" onclick="showView('viewWorkers')">ğŸ‘¨â€ğŸŒ¾ Trabajadores</button>
        <button type="button" onclick="showView('viewWorkersDB')">ğŸ“‹ Base de Datos Trabajadores</button>
        <button type="button" onclick="showView('viewProduction')">ğŸ› ï¸ ProducciÃ³n</button>
        <button type="button" onclick="showView('viewLiquidation')">ğŸ“„ LiquidaciÃ³n</button>
        <button type="button" onclick="showView('viewMonthly')">ğŸ“… Mensual Trabajador</button>
        <button type="button" onclick="showView('viewMonthlyGeneral')">ğŸ§¾ Mensual General</button>
        <button type="button" onclick="showView('viewWeekly')">ğŸ“Š Semanal</button>
        <button type="button" onclick="showView('viewHistory')">ğŸ“œ Historial</button>
        <button type="button" onclick="showView('viewBackup')">ğŸ’¾ Respaldo</button>
        <button type="button" onclick="showView('viewContract')">ğŸ§¾ Contrato</button>
    </aside>

    <!-- CONTENIDO -->
    <main class="content">

        <header>
            <h1>Sistema de ProducciÃ³n AgrÃ­cola</h1>
            <button type="button" onclick="logout()">
                Cerrar sesiÃ³n
            </button>
        </header>

        <!-- INICIO -->
        <section class="view" id="viewHome">
            <div class="homeScreen">
                <h2>Bienvenido al Sistema AgrÃ­cola</h2>
                <p>Seleccione una opciÃ³n del menÃº lateral</p>
            </div>
        </section>

        <!-- TRABAJADORES -->
        <section class="card view hidden" id="viewWorkers">
            <h2>Registrar Trabajador</h2>

            <select id="workerEditSelect" onchange="loadWorkerToEdit()">
                <option value="">-- Seleccionar para editar --</option>
            </select>

            <input type="text" id="workerName" placeholder="Nombre">
            <input type="text" id="workerRut" placeholder="RUT" oninput="formatRutInput(this)">
            <input type="text" id="workerAddress" placeholder="DirecciÃ³n">

            <button type="button" onclick="addWorker()">Guardar</button>

            <button type="button"
                    onclick="deleteWorker()"
                    style="background:#c0392b">
                Eliminar Trabajador
            </button>
        </section>

        <!-- BASE DE DATOS -->
        <section class="card view hidden" id="viewWorkersDB">
            <h2>Base de Datos de Trabajadores</h2>
            <div id="workersTable"></div>
        </section>

        <!-- PRODUCCIÃ“N -->
        <section class="card view hidden" id="viewProduction">
            <h2>Registrar ProducciÃ³n</h2>

            <select id="workerSelect">
                <option value="">-- Seleccionar trabajador --</option>
            </select>

            <input type="date" id="workDate">

            <select id="laborSelect">
                <option value="">-- Seleccionar labor --</option>
            </select>

            <input type="text"
                   id="newLabor"
                   placeholder="Nueva labor (opcional)">

            <input type="number"
                   id="quantity"
                   placeholder="Cantidad"
                   min="0"
                   step="1">

            <input type="text"
                   id="unitValue"
                   placeholder="Valor por unidad"
                   oninput="formatCurrency(this)">

            <input type="text"
                   id="observation"
                   placeholder="ObservaciÃ³n">

            <button type="button" onclick="registerWork()">
                Registrar
            </button>

            <button type="button" onclick="editLastProduction()">
                âœï¸ Modificar Ãºltimo
            </button>

            <button type="button"
                    onclick="deleteLastProduction()"
                    style="background:#c0392b">
                ğŸ—‘ï¸ Eliminar Ãºltimo
            </button>
        </section>

        <!-- LIQUIDACIÃ“N -->
        <section class="card view hidden" id="viewLiquidation">
            <h2>LiquidaciÃ³n Mensual</h2>

            <select id="workerLiquidation">
                <option value="">-- Seleccionar trabajador --</option>
            </select>

            <input type="month" id="monthLiquidation">

            <button type="button" onclick="generateLiquidation()">
                Generar PDF
            </button>
        </section>

        <!-- CONTRATO -->
        <section class="card view hidden" id="viewContract">
            <h2>Contrato de Trabajo</h2>

            <select id="workerContract">
                <option value="">-- Seleccionar trabajador --</option>
            </select>

            <input type="text" id="faena" placeholder="Faena / Campo">
            <input type="text" id="cargo" placeholder="Cargo / Labor">
            <input type="text" id="afp" placeholder="AFP">
            <input type="date" id="startDate">
            <input type="text" id="salary" placeholder="Sueldo / Trato">

            <button type="button" onclick="generateContract()">
                Generar Contrato
            </button>
        </section>

        <!-- MENSUAL -->
        <section class="card view hidden" id="viewMonthly">
            <h2>Resumen Mensual por Trabajador</h2>

            <select id="workerMonthly">
                <option value="">-- Seleccionar trabajador --</option>
            </select>

            <input type="month" id="monthMonthly">

            <button type="button" onclick="generateMonthlySummary()">
                Calcular Mes
            </button>

            <div id="monthlyResult"></div>
        </section>

        <!-- MENSUAL GENERAL -->
        <section class="card view hidden" id="viewMonthlyGeneral">
            <h2>Resumen Mensual General</h2>

            <input type="month" id="monthGeneral">

            <button type="button" onclick="generateMonthlyGeneral()">
                Calcular Mes
            </button>

            <div id="monthlyGeneralResult"></div>
        </section>

        <!-- SEMANAL -->
        <section class="card view hidden" id="viewWeekly">
            <h2>Resumen Semanal</h2>

            <button type="button"
                    onclick="window.location.href='historial.html'">
                Ver Historial Completo
            </button>

            <input type="text"
                   id="searchWorkerWeekly"
                   placeholder="Buscar por nombre o RUT"
                   oninput="filterWorkersWeekly()">

            <select id="workerWeekly">
                <option value="">-- Seleccionar trabajador --</option>
            </select>

            <input type="week" id="weekSelected">

            <button type="button" onclick="generateWeeklySummary()">
                Calcular Semana
            </button>

            <div id="weeklyResult"></div>
        </section>

        <!-- HISTORIAL -->
        <section class="card view hidden" id="viewHistory">
            <h2>Historial</h2>
            <div id="history"></div>
        </section>

        <!-- RESPALDO -->
        <section class="card view hidden" id="viewBackup">
            <h3>Respaldo del Sistema</h3>

            <button type="button" onclick="exportData()">
                Exportar Respaldo
            </button>

            <input type="file"
                   id="importFile"
                   style="display:none"
                   onchange="importData(event)">

            <button type="button"
                    onclick="document.getElementById('importFile').click()">
                Importar Respaldo
            </button>
        </section>

    </main>
</div>

<!-- LIBRERÃA PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- APP JS -->
<script src="app.js"></script>

</body>
</html>

